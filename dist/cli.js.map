{"version":3,"file":"cli.js","sources":["../src/lib/transform-fast-rest.js","../src/utils.js","../src/lib/babel-custom.js","../src/log-error.js","../src/lib/compressed-size.js","../src/lib/terser.js","../src/lib/option-normalization.js","../src/lib/package-info.js","../src/lib/css-modules.js","../src/index.js","../src/prog.js","../src/cli.js"],"sourcesContent":["/**\r\n * @type {import('@babel/core')}\r\n */\r\n\r\n/**\r\n * Transform ...rest parameters to [].slice.call(arguments,offset).\r\n * Demo: https://astexplorer.net/#/gist/70aaa0306db9a642171ef3e2f35df2e0/576c150f647e4936fa6960e0453a11cdc5d81f21\r\n * Benchmark: https://jsperf.com/rest-arguments-babel-pr-9152/4\r\n * @param {object} opts\r\n * @param {babel.template} opts.template\r\n * @param {babel.types} opts.types\r\n * @returns {babel.PluginObj}\r\n */\r\nexport default function fastRestTransform({ template, types: t }) {\r\n\tconst slice = template`var IDENT = Array.prototype.slice;`;\r\n\r\n\tconst VISITOR = {\r\n\t\tRestElement(path, state) {\r\n\t\t\tif (path.parentKey !== 'params') return;\r\n\r\n\t\t\t// Create a global _slice alias\r\n\t\t\tlet slice = state.get('slice');\r\n\t\t\tif (!slice) {\r\n\t\t\t\tslice = path.scope.generateUidIdentifier('slice');\r\n\t\t\t\tstate.set('slice', slice);\r\n\t\t\t}\r\n\r\n\t\t\t// _slice.call(arguments) or _slice.call(arguments, 1)\r\n\t\t\tconst args = [t.identifier('arguments')];\r\n\t\t\tif (path.key) args.push(t.numericLiteral(path.key));\r\n\t\t\tconst sliced = t.callExpression(\r\n\t\t\t\tt.memberExpression(t.clone(slice), t.identifier('call')),\r\n\t\t\t\targs,\r\n\t\t\t);\r\n\r\n\t\t\tconst ident = path.node.argument;\r\n\t\t\tconst binding = path.scope.getBinding(ident.name);\r\n\r\n\t\t\tif (binding.referencePaths.length !== 0) {\r\n\t\t\t\t// arguments access requires a non-Arrow function:\r\n\t\t\t\tconst func = path.parentPath;\r\n\t\t\t\tif (t.isArrowFunctionExpression(func)) {\r\n\t\t\t\t\tfunc.arrowFunctionToExpression();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (binding.constant && binding.referencePaths.length === 1) {\r\n\t\t\t\t\t// one usage, never assigned - replace usage inline\r\n\t\t\t\t\tbinding.referencePaths[0].replaceWith(sliced);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// unknown usage, create a binding\r\n\t\t\t\t\tconst decl = t.variableDeclaration('var', [\r\n\t\t\t\t\t\tt.variableDeclarator(t.clone(ident), sliced),\r\n\t\t\t\t\t]);\r\n\t\t\t\t\tfunc.get('body').unshiftContainer('body', decl);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tpath.remove();\r\n\t\t},\r\n\t};\r\n\r\n\treturn {\r\n\t\tname: 'transform-fast-rest',\r\n\t\tvisitor: {\r\n\t\t\tProgram(path, state) {\r\n\t\t\t\tconst childState = new Map();\r\n\t\t\t\tconst useHelper = state.opts.helper === true; // defaults to false\r\n\r\n\t\t\t\tif (!useHelper) {\r\n\t\t\t\t\tlet inlineHelper;\r\n\t\t\t\t\tif (state.opts.literal === false) {\r\n\t\t\t\t\t\tinlineHelper = template.expression.ast`Array.prototype.slice`;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tinlineHelper = template.expression.ast`[].slice`;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tchildState.set('slice', inlineHelper);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpath.traverse(VISITOR, childState);\r\n\r\n\t\t\t\tconst name = childState.get('slice');\r\n\t\t\t\tif (name && useHelper) {\r\n\t\t\t\t\tconst helper = slice({ IDENT: name });\r\n\t\t\t\t\tt.addComment(helper.declarations[0].init, 'leading', '#__PURE__');\r\n\t\t\t\t\tpath.unshiftContainer('body', helper);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t};\r\n}\r\n","import { promises as fs } from 'fs';\r\nimport camelCase from 'camelcase';\r\n\r\nexport const readFile = fs.readFile;\r\n\r\nexport const stat = fs.stat;\r\n\r\nexport function isDir(name) {\r\n\treturn stat(name)\r\n\t\t.then(stats => stats.isDirectory())\r\n\t\t.catch(() => false);\r\n}\r\n\r\nexport function isFile(name) {\r\n\treturn stat(name)\r\n\t\t.then(stats => stats.isFile())\r\n\t\t.catch(() => false);\r\n}\r\n\r\n// eslint-disable-next-line no-console\r\nexport const stdout = console.log.bind(console);\r\nexport const stderr = console.error.bind(console);\r\n\r\nexport const isTruthy = obj => {\r\n\tif (!obj) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\treturn obj.constructor !== Object || Object.keys(obj).length > 0;\r\n};\r\n\r\n/** Remove a @scope/ prefix from a package name string */\r\nexport const removeScope = name => name.replace(/^@.*\\//, '');\r\n\r\nconst INVALID_ES3_IDENT = /((^[^a-zA-Z]+)|[^\\w.-])|([^a-zA-Z0-9]+$)/g;\r\n\r\n/**\r\n * Turn a package name into a valid reasonably-unique variable name\r\n * @param {string} name\r\n */\r\nexport function safeVariableName(name) {\r\n\tconst normalized = removeScope(name).toLowerCase();\r\n\tconst identifier = normalized.replace(INVALID_ES3_IDENT, '');\r\n\treturn camelCase(identifier);\r\n}\r\n","import { createBabelInputPluginFactory } from '@rollup/plugin-babel';\nimport merge from 'lodash.merge';\nimport transformFastRest from './transform-fast-rest';\nimport { isTruthy } from '../utils';\n\nconst ESMODULES_TARGET = {\n\tesmodules: true,\n};\n\nconst mergeConfigItems = (babel, type, ...configItemsToMerge) => {\n\tconst mergedItems = [];\n\n\tconfigItemsToMerge.forEach(configItemToMerge => {\n\t\tconfigItemToMerge.forEach(item => {\n\t\t\tconst itemToMergeWithIndex = mergedItems.findIndex(\n\t\t\t\tmergedItem =>\n\t\t\t\t\t(mergedItem.name || mergedItem.file.resolved) ===\n\t\t\t\t\t(item.name || item.file.resolved),\n\t\t\t);\n\n\t\t\tif (itemToMergeWithIndex === -1) {\n\t\t\t\tmergedItems.push(item);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmergedItems[itemToMergeWithIndex] = babel.createConfigItem(\n\t\t\t\t[\n\t\t\t\t\tmergedItems[itemToMergeWithIndex].file.resolved,\n\t\t\t\t\tmerge(mergedItems[itemToMergeWithIndex].options, item.options),\n\t\t\t\t],\n\t\t\t\t{\n\t\t\t\t\ttype,\n\t\t\t\t},\n\t\t\t);\n\t\t});\n\t});\n\n\treturn mergedItems;\n};\n\nconst createConfigItems = (babel, type, items) => {\n\treturn items.map(item => {\n\t\tlet { name, value, ...options } = item;\n\t\tvalue = value || [require.resolve(name), options];\n\t\treturn babel.createConfigItem(value, { type });\n\t});\n};\n\nconst environmentPreset = '@babel/preset-env';\n// capture both @babel/env & @babel/preset-env (https://babeljs.io/docs/en/presets#preset-shorthand)\nconst presetEnvRegex = new RegExp(/@babel\\/(preset-)?env/);\n\nexport default () => {\n\treturn createBabelInputPluginFactory(babelCore => {\n\t\treturn {\n\t\t\t// Passed the plugin options.\n\t\t\toptions({ custom: customOptions, ...pluginOptions }) {\n\t\t\t\treturn {\n\t\t\t\t\t// Pull out any custom options that the plugin might have.\n\t\t\t\t\tcustomOptions,\n\n\t\t\t\t\t// Pass the options back with the two custom options removed.\n\t\t\t\t\tpluginOptions,\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tconfig(config, { customOptions }) {\n\t\t\t\tconst targets = customOptions.targets;\n\t\t\t\tconst isNodeTarget = targets && targets.node != null;\n\n\t\t\t\tconst defaultPlugins = createConfigItems(\n\t\t\t\t\tbabelCore,\n\t\t\t\t\t'plugin',\n\t\t\t\t\t[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: '@babel/plugin-syntax-import-meta',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t!customOptions.jsxImportSource && {\n\t\t\t\t\t\t\tname: '@babel/plugin-transform-react-jsx',\n\t\t\t\t\t\t\tpragma: customOptions.pragma || 'h',\n\t\t\t\t\t\t\tpragmaFrag: customOptions.pragmaFrag || 'Fragment',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t!customOptions.typescript && {\n\t\t\t\t\t\t\tname: '@babel/plugin-transform-flow-strip-types',\n\t\t\t\t\t\t},\n\t\t\t\t\t\tisTruthy(customOptions.defines) && {\n\t\t\t\t\t\t\tname: 'babel-plugin-transform-replace-expressions',\n\t\t\t\t\t\t\treplace: customOptions.defines,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t!customOptions.modern &&\n\t\t\t\t\t\t\t!isNodeTarget && {\n\t\t\t\t\t\t\t\tname: 'babel-plugin-transform-async-to-promises',\n\t\t\t\t\t\t\t\tinlineHelpers: true,\n\t\t\t\t\t\t\t\texternalHelpers: false,\n\t\t\t\t\t\t\t\tminify: true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t!customOptions.modern &&\n\t\t\t\t\t\t\t!isNodeTarget && {\n\t\t\t\t\t\t\t\tvalue: [\n\t\t\t\t\t\t\t\t\ttransformFastRest,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t// Use inline [].slice.call(arguments)\n\t\t\t\t\t\t\t\t\t\thelper: false,\n\t\t\t\t\t\t\t\t\t\tliteral: true,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t'transform-fast-rest',\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: '@babel/plugin-proposal-class-properties',\n\t\t\t\t\t\t\tloose: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t!customOptions.modern &&\n\t\t\t\t\t\t\t!isNodeTarget && {\n\t\t\t\t\t\t\t\tname: '@babel/plugin-transform-regenerator',\n\t\t\t\t\t\t\t\tasync: false,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: '@babel/plugin-proposal-decorators',\n\t\t\t\t\t\t\tlegacy: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: '@babel/plugin-proposal-export-default-from',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: '@babel/plugin-proposal-export-namespace-from',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: '@babel/plugin-proposal-do-expressions',\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: 'babel-plugin-macros',\n\t\t\t\t\t\t},\n\n\t\t\t\t\t].filter(Boolean),\n\t\t\t\t);\n\n\t\t\t\tconst babelOptions = config.options || {};\n\n\t\t\t\tconst envIdx = (babelOptions.presets || []).findIndex(preset =>\n\t\t\t\t\tpresetEnvRegex.test(preset.file.request),\n\t\t\t\t);\n\n\t\t\t\tif (envIdx !== -1) {\n\t\t\t\t\tconst preset = babelOptions.presets[envIdx];\n\t\t\t\t\tbabelOptions.presets[envIdx] = babelCore.createConfigItem(\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\trequire.resolve(environmentPreset),\n\t\t\t\t\t\t\tObject.assign(\n\t\t\t\t\t\t\t\tmerge(\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tloose: true,\n\t\t\t\t\t\t\t\t\t\tuseBuiltIns: false,\n\t\t\t\t\t\t\t\t\t\ttargets: customOptions.targets,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tpreset.options,\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tbugfixes: customOptions.modern,\n\t\t\t\t\t\t\t\t\t\tmodules: false,\n\t\t\t\t\t\t\t\t\t\texclude: merge(\n\t\t\t\t\t\t\t\t\t\t\t['transform-async-to-generator', 'transform-regenerator'],\n\t\t\t\t\t\t\t\t\t\t\t(preset.options && preset.options.exclude) || [],\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tcustomOptions.modern ? { targets: ESMODULES_TARGET } : {},\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t],\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: `preset`,\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tbabelOptions.presets = createConfigItems(\n\t\t\t\t\t\tbabelCore,\n\t\t\t\t\t\t'preset',\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tname: environmentPreset,\n\t\t\t\t\t\t\t\ttargets: customOptions.modern\n\t\t\t\t\t\t\t\t\t? ESMODULES_TARGET\n\t\t\t\t\t\t\t\t\t: customOptions.targets,\n\t\t\t\t\t\t\t\tmodules: false,\n\t\t\t\t\t\t\t\tloose: true,\n\t\t\t\t\t\t\t\tuseBuiltIns: false,\n\t\t\t\t\t\t\t\tbugfixes: customOptions.modern,\n\t\t\t\t\t\t\t\texclude: [\n\t\t\t\t\t\t\t\t\t'transform-async-to-generator',\n\t\t\t\t\t\t\t\t\t'transform-regenerator',\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcustomOptions.jsxImportSource && {\n\t\t\t\t\t\t\t\tname: '@babel/preset-react',\n\t\t\t\t\t\t\t\truntime: 'automatic',\n\t\t\t\t\t\t\t\timportSource: customOptions.jsxImportSource,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t].filter(Boolean),\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// Merge babelrc & our plugins together\n\t\t\t\tbabelOptions.plugins = mergeConfigItems(\n\t\t\t\t\tbabelCore,\n\t\t\t\t\t'plugin',\n\t\t\t\t\tdefaultPlugins,\n\t\t\t\t\tbabelOptions.plugins || [],\n\t\t\t\t);\n\n\t\t\t\tif (customOptions.compress) {\n\t\t\t\t\tbabelOptions.generatorOpts = {\n\t\t\t\t\t\tminified: true,\n\t\t\t\t\t\tcompact: true,\n\t\t\t\t\t\tshouldPrintComment: comment => /[@#]__PURE__/.test(comment),\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn babelOptions;\n\t\t\t},\n\t\t};\n\t});\n};\n","import { red, dim } from 'kleur';\r\nimport { stderr } from './utils';\r\n\r\nexport default function logError(err) {\r\n\tconst error = err.error || err;\r\n\tconst description = `${error.name ? error.name + ': ' : ''}${error.message ||\r\n\t\terror}`;\r\n\tconst message = error.plugin\r\n\t\t? `(${error.plugin} plugin) ${description}`\r\n\t\t: description;\r\n\r\n\tstderr(red().bold(message));\r\n\r\n\tif (error.loc) {\r\n\t\tstderr();\r\n\t\tstderr(`at ${error.loc.file}:${error.loc.line}:${error.loc.column}`);\r\n\t}\r\n\r\n\tif (error.frame) {\r\n\t\tstderr();\r\n\t\tstderr(dim(error.frame));\r\n\t} else if (err.stack) {\r\n\t\tconst headlessStack = error.stack.replace(message, '');\r\n\t\tstderr(dim(headlessStack));\r\n\t}\r\n\r\n\tstderr();\r\n}\r\n","import { basename } from 'path';\r\nimport { green, red, yellow, white } from 'kleur';\r\nimport gzipSize from 'gzip-size';\r\nimport brotliSize from 'brotli-size';\r\nimport prettyBytes from 'pretty-bytes';\r\n\r\nfunction getPadLeft(str, width, char = ' ') {\r\n\treturn char.repeat(width - str.length);\r\n}\r\n\r\nfunction formatSize(size, filename, type, raw) {\r\n\tconst pretty = raw ? `${size} B` : prettyBytes(size);\r\n\tconst color = size < 5000 ? green : size > 40000 ? red : yellow;\r\n\tconst indent = getPadLeft(pretty, type === 'br' ? 13 : 10);\r\n\treturn `${indent}${color(pretty)}: ${white(basename(filename))}.${type}`;\r\n}\r\n\r\nexport async function getSizeInfo(code, filename, raw) {\r\n\traw = raw || code.length < 5000;\r\n\r\n\tconst [gzip, brotli] = await Promise.all([\r\n\t\tgzipSize(code).catch(() => null),\r\n\t\tbrotliSize(code).catch(() => null),\r\n\t]);\r\n\r\n\tlet out = formatSize(gzip, filename, 'gz', raw);\r\n\tif (brotli) {\r\n\t\tout += '\\n' + formatSize(brotli, filename, 'br', raw);\r\n\t}\r\n\r\n\treturn out;\r\n}\r\n","// Normalize Terser options from microbundle's relaxed JSON format (mutates argument in-place)\r\nexport function normalizeMinifyOptions(minifyOptions) {\r\n\tconst mangle = minifyOptions.mangle || (minifyOptions.mangle = {});\r\n\tlet properties = mangle.properties;\r\n\r\n\t// allow top-level \"properties\" key to override mangle.properties (including {properties:false}):\r\n\tif (minifyOptions.properties != null) {\r\n\t\tproperties = mangle.properties =\r\n\t\t\tminifyOptions.properties &&\r\n\t\t\tObject.assign(properties, minifyOptions.properties);\r\n\t}\r\n\r\n\t// allow previous format ({ mangle:{regex:'^_',reserved:[]} }):\r\n\tif (minifyOptions.regex || minifyOptions.reserved) {\r\n\t\tif (!properties) properties = mangle.properties = {};\r\n\t\tproperties.regex = properties.regex || minifyOptions.regex;\r\n\t\tproperties.reserved = properties.reserved || minifyOptions.reserved;\r\n\t}\r\n\r\n\tif (properties) {\r\n\t\tif (properties.regex) properties.regex = new RegExp(properties.regex);\r\n\t\tproperties.reserved = [].concat(properties.reserved || []);\r\n\t}\r\n}\r\n","/**\r\n * Convert booleans and int define= values to literals.\r\n * This is more intuitive than `microbundle --define A=1` producing A=\"1\".\r\n */\r\nexport function toReplacementExpression(value, name) {\r\n\t// --define A=\"1\",B='true' produces string:\r\n\tconst matches = value.match(/^(['\"])(.+)\\1$/);\r\n\tif (matches) {\r\n\t\treturn [JSON.stringify(matches[2]), name];\r\n\t}\r\n\r\n\t// --define @assign=Object.assign replaces expressions with expressions:\r\n\tif (name[0] === '@') {\r\n\t\treturn [value, name.substring(1)];\r\n\t}\r\n\r\n\t// --define A=1,B=true produces int/boolean literal:\r\n\tif (/^(true|false|\\d+)$/i.test(value)) {\r\n\t\treturn [value, name];\r\n\t}\r\n\r\n\t// default: string literal\r\n\treturn [JSON.stringify(value), name];\r\n}\r\n\r\n/**\r\n * Parses values of the form \"$=jQuery,React=react\" into key-value object pairs.\r\n */\r\nexport function parseMappingArgument(globalStrings, processValue) {\r\n\tconst globals = {};\r\n\tglobalStrings.split(',').forEach(globalString => {\r\n\t\tlet [key, value] = globalString.split('=');\r\n\t\tif (processValue) {\r\n\t\t\tconst r = processValue(value, key);\r\n\t\t\tif (r !== undefined) {\r\n\t\t\t\tif (Array.isArray(r)) {\r\n\t\t\t\t\t[value, key] = r;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvalue = r;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tglobals[key] = value;\r\n\t});\r\n\treturn globals;\r\n}\r\n\r\n/**\r\n * Parses values of the form \"$=jQuery,React=react\" into key-value object pairs.\r\n */\r\nexport function parseAliasArgument(aliasStrings) {\r\n\treturn aliasStrings.split(',').map(str => {\r\n\t\tlet [key, value] = str.split('=');\r\n\t\treturn { find: key, replacement: value };\r\n\t});\r\n}\r\n","import { resolve, basename } from 'path';\r\nimport { red, yellow } from 'kleur';\r\nimport { readFile, stderr, safeVariableName } from '../utils';\r\n\r\n/** */\r\nexport async function getConfigFromPkgJson(cwd) {\r\n\tlet hasPackageJson = false;\r\n\tlet pkg;\r\n\ttry {\r\n\t\tconst packageJson = await readFile(resolve(cwd, 'package.json'), 'utf8');\r\n\t\tpkg = JSON.parse(packageJson);\r\n\t\thasPackageJson = true;\r\n\t} catch (err) {\r\n\t\tconst pkgName = basename(cwd);\r\n\r\n\t\tstderr(\r\n\t\t\tyellow().inverse('WARN'),\r\n\t\t\tyellow(` no package.json, assuming package name is \"${pkgName}\".`),\r\n\t\t);\r\n\r\n\t\tlet msg = String(err.message || err);\r\n\t\tif (!msg.match(/ENOENT/)) stderr(`  ${red().dim(msg)}`);\r\n\r\n\t\tpkg = { name: pkgName };\r\n\t}\r\n\r\n\treturn { hasPackageJson, pkg };\r\n}\r\nexport function getName({ name, pkgName, amdName, cwd, hasPackageJson }) {\r\n\tif (!pkgName) {\r\n\t\tpkgName = basename(cwd);\r\n\t\tif (hasPackageJson) {\r\n\t\t\tstderr(\r\n\t\t\t\tyellow().inverse('WARN'),\r\n\t\t\t\tyellow(` missing package.json \"name\" field. Assuming \"${pkgName}\".`),\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tconst finalName = name || amdName || safeVariableName(pkgName);\r\n\r\n\treturn { finalName, pkgName };\r\n}\r\n","export function shouldCssModules(options) {\r\n\tconst passedInOption = processCssmodulesArgument(options);\r\n\r\n\t// We should module when my-file.module.css or my-file.css\r\n\tconst moduleAllCss = passedInOption === true;\r\n\r\n\t// We should module when my-file.module.css\r\n\tconst allowOnlySuffixModule = passedInOption === null;\r\n\r\n\treturn moduleAllCss || allowOnlySuffixModule;\r\n}\r\n\r\nexport function cssModulesConfig(options) {\r\n\tconst passedInOption = processCssmodulesArgument(options);\r\n\tconst isWatchMode = options.watch;\r\n\tconst hasPassedInScopeName = !(\r\n\t\ttypeof passedInOption === 'boolean' || passedInOption === null\r\n\t);\r\n\r\n\tif (shouldCssModules(options) || hasPassedInScopeName) {\r\n\t\tlet generateScopedName = isWatchMode\r\n\t\t\t? '_[name]__[local]__[hash:base64:5]'\r\n\t\t\t: '_[hash:base64:5]';\r\n\r\n\t\tif (hasPassedInScopeName) {\r\n\t\t\tgenerateScopedName = passedInOption; // would be the string from --css-modules \"_[hash]\".\r\n\t\t}\r\n\r\n\t\treturn { generateScopedName };\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\n/**\r\n * This is done because if you use the cli default property, you get a primiatve \"null\" or \"false\",\r\n * but when using the cli arguments, you always get back strings. This method aims at correcting those\r\n * for both realms. So that both realms _convert_ into primatives.\r\n */\r\nfunction processCssmodulesArgument(options) {\r\n\tif (options['css-modules'] === 'true' || options['css-modules'] === true)\r\n\t\treturn true;\r\n\tif (options['css-modules'] === 'false' || options['css-modules'] === false)\r\n\t\treturn false;\r\n\tif (options['css-modules'] === 'null' || options['css-modules'] === null)\r\n\t\treturn null;\r\n\r\n\treturn options['css-modules'];\r\n}\r\n","import fs from 'fs';\nimport { resolve, relative, dirname, basename, extname } from 'path';\nimport camelCase from 'camelcase';\nimport escapeStringRegexp from 'escape-string-regexp';\nimport { blue } from 'kleur';\nimport { map, series } from 'asyncro';\nimport glob from 'tiny-glob/sync';\nimport autoprefixer from 'autoprefixer';\nimport cssnano from 'cssnano';\nimport { rollup, watch } from 'rollup';\nimport builtinModules from 'builtin-modules';\nimport commonjs from '@rollup/plugin-commonjs';\nimport babel from '@rollup/plugin-babel';\nimport customBabel from './lib/babel-custom';\nimport nodeResolve from '@rollup/plugin-node-resolve';\nimport { terser } from 'rollup-plugin-terser';\nimport alias from '@rollup/plugin-alias';\nimport postcss from 'rollup-plugin-postcss';\nimport typescript from 'rollup-plugin-typescript2';\nimport json from '@rollup/plugin-json';\nimport logError from './log-error';\nimport { isDir, isFile, stdout, isTruthy, removeScope } from './utils';\nimport { getSizeInfo } from './lib/compressed-size';\nimport { normalizeMinifyOptions } from './lib/terser';\nimport {\n\tparseAliasArgument,\n\tparseMappingArgument,\n\ttoReplacementExpression,\n} from './lib/option-normalization';\nimport { getConfigFromPkgJson, getName } from './lib/package-info';\nimport { shouldCssModules, cssModulesConfig } from './lib/css-modules';\nimport vue from 'rollup-plugin-vue' // @ttungbmt\nimport css from 'rollup-plugin-css-only' // @ttungbmt\n\n// Extensions to use when resolving modules\nconst EXTENSIONS = ['.ts', '.tsx', '.js', '.jsx', '.es6', '.es', '.mjs'];\n\nconst WATCH_OPTS = {\n\texclude: 'node_modules/**',\n};\n\nexport default async function microbundle(inputOptions) {\n\tlet options = { ...inputOptions };\n\n\toptions.cwd = resolve(process.cwd(), inputOptions.cwd);\n\tconst cwd = options.cwd;\n\n\tconst { hasPackageJson, pkg } = await getConfigFromPkgJson(cwd);\n\toptions.pkg = pkg;\n\n\tconst { finalName, pkgName } = getName({\n\t\tname: options.name,\n\t\tpkgName: options.pkg.name,\n\t\tamdName: options.pkg.amdName,\n\t\thasPackageJson,\n\t\tcwd,\n\t});\n\n\toptions.name = finalName;\n\toptions.pkg.name = pkgName;\n\n\tif (options.sourcemap !== false) {\n\t\toptions.sourcemap = true;\n\t}\n\n\toptions.input = await getInput({\n\t\tentries: options.entries,\n\t\tcwd,\n\t\tsource: options.pkg.source,\n\t\tmodule: options.pkg.module,\n\t});\n\n\toptions.output = await getOutput({\n\t\tcwd,\n\t\toutput: options.output,\n\t\tpkgMain: options.pkg.main,\n\t\tpkgName: options.pkg.name,\n\t});\n\n\toptions.entries = await getEntries({\n\t\tcwd,\n\t\tinput: options.input,\n\t});\n\n\toptions.multipleEntries = options.entries.length > 1;\n\n\tlet formats = (options.format || options.formats).split(',');\n\t// de-dupe formats and convert \"esm\" to \"es\":\n\tformats = Array.from(new Set(formats.map(f => (f === 'esm' ? 'es' : f))));\n\t// always compile cjs first if it's there:\n\tformats.sort((a, b) => (a === 'cjs' ? -1 : a > b ? 1 : 0));\n\n\tlet steps = [];\n\tfor (let i = 0; i < options.entries.length; i++) {\n\t\tfor (let j = 0; j < formats.length; j++) {\n\t\t\tsteps.push(\n\t\t\t\tcreateConfig(\n\t\t\t\t\toptions,\n\t\t\t\t\toptions.entries[i],\n\t\t\t\t\tformats[j],\n\t\t\t\t\ti === 0 && j === 0,\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t}\n\n\tif (options.watch) {\n\t\treturn doWatch(options, cwd, steps);\n\t}\n\n\tlet cache;\n\tlet out = await series(\n\t\tsteps.map(config => async () => {\n\t\t\tconst { inputOptions, outputOptions } = config;\n\t\t\tif (inputOptions.cache !== false) {\n\t\t\t\tinputOptions.cache = cache;\n\t\t\t}\n\t\t\tlet bundle = await rollup(inputOptions);\n\t\t\tcache = bundle;\n\t\t\tawait bundle.write(outputOptions);\n\t\t\treturn await config._sizeInfo;\n\t\t}),\n\t);\n\n\tconst targetDir = relative(cwd, dirname(options.output)) || '.';\n\tconst banner = blue(`Build \"${options.name}\" to ${targetDir}:`);\n\treturn {\n\t\toutput: `${banner}\\n   ${out.join('\\n   ')}`,\n\t};\n}\n\nfunction doWatch(options, cwd, steps) {\n\tconst { onStart, onBuild, onError } = options;\n\n\treturn new Promise((resolve, reject) => {\n\t\tconst targetDir = relative(cwd, dirname(options.output));\n\t\tstdout(blue(`Watching source, compiling to ${targetDir}:`));\n\n\t\tconst watchers = steps.reduce((acc, options) => {\n\t\t\tacc[options.inputOptions.input] = watch(\n\t\t\t\tObject.assign(\n\t\t\t\t\t{\n\t\t\t\t\t\toutput: options.outputOptions,\n\t\t\t\t\t\twatch: WATCH_OPTS,\n\t\t\t\t\t},\n\t\t\t\t\toptions.inputOptions,\n\t\t\t\t),\n\t\t\t).on('event', e => {\n\t\t\t\tif (e.code === 'START') {\n\t\t\t\t\tif (typeof onStart === 'function') {\n\t\t\t\t\t\tonStart(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (e.code === 'ERROR') {\n\t\t\t\t\tlogError(e.error);\n\t\t\t\t\tif (typeof onError === 'function') {\n\t\t\t\t\t\tonError(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (e.code === 'END') {\n\t\t\t\t\toptions._sizeInfo.then(text => {\n\t\t\t\t\t\tstdout(`Wrote ${text.trim()}`);\n\t\t\t\t\t});\n\t\t\t\t\tif (typeof onBuild === 'function') {\n\t\t\t\t\t\tonBuild(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn acc;\n\t\t}, {});\n\n\t\tresolve({ watchers });\n\t});\n}\n\nasync function jsOrTs(cwd, filename) {\n\tconst extension = (await isFile(resolve(cwd, filename + '.ts')))\n\t\t? '.ts'\n\t\t: (await isFile(resolve(cwd, filename + '.tsx')))\n\t\t? '.tsx'\n\t\t: '.js';\n\n\treturn resolve(cwd, `${filename}${extension}`);\n}\n\nasync function getInput({ entries, cwd, source, module }) {\n\tconst input = [];\n\n\t[]\n\t\t.concat(\n\t\t\tentries && entries.length\n\t\t\t\t? entries\n\t\t\t\t: (source &&\n\t\t\t\t\t\t(Array.isArray(source) ? source : [source]).map(file =>\n\t\t\t\t\t\t\tresolve(cwd, file),\n\t\t\t\t\t\t)) ||\n\t\t\t\t\t\t((await isDir(resolve(cwd, 'src'))) &&\n\t\t\t\t\t\t\t(await jsOrTs(cwd, 'src/index'))) ||\n\t\t\t\t\t\t(await jsOrTs(cwd, 'index')) ||\n\t\t\t\t\t\tmodule,\n\t\t)\n\t\t.map(file => glob(file))\n\t\t.forEach(file => input.push(...file));\n\n\treturn input;\n}\n\nasync function getOutput({ cwd, output, pkgMain, pkgName }) {\n\tlet main = resolve(cwd, output || pkgMain || 'dist');\n\tif (!main.match(/\\.[a-z]+$/) || (await isDir(main))) {\n\t\tmain = resolve(main, `${removeScope(pkgName)}.js`);\n\t}\n\treturn main;\n}\n\nfunction getDeclarationDir({ options, pkg }) {\n\tconst { cwd, output } = options;\n\n\tlet result = output;\n\n\tif (pkg.types || pkg.typings) {\n\t\tresult = pkg.types || pkg.typings;\n\t\tresult = resolve(cwd, result);\n\t}\n\n\tresult = dirname(result);\n\n\treturn result;\n}\n\nasync function getEntries({ input, cwd }) {\n\tlet entries = (\n\t\tawait map([].concat(input), async file => {\n\t\t\tfile = resolve(cwd, file);\n\t\t\tif (await isDir(file)) {\n\t\t\t\tfile = resolve(file, 'index.js');\n\t\t\t}\n\t\t\treturn file;\n\t\t})\n\t).filter((item, i, arr) => arr.indexOf(item) === i);\n\treturn entries;\n}\n\nfunction replaceName(filename, name) {\n\treturn resolve(\n\t\tdirname(filename),\n\t\tname + basename(filename).replace(/^[^.]+/, ''),\n\t);\n}\n\nfunction getMain({ options, entry, format }) {\n\tconst { pkg } = options;\n\tconst pkgMain = options['pkg-main'];\n\n\tif (!pkgMain) {\n\t\treturn options.output;\n\t}\n\n\tlet mainNoExtension = options.output;\n\tif (options.multipleEntries) {\n\t\tlet name = entry.match(/([\\\\/])index(\\.(umd|cjs|es|m))?\\.(mjs|[tj]sx?)$/)\n\t\t\t? mainNoExtension\n\t\t\t: entry;\n\t\tmainNoExtension = resolve(dirname(mainNoExtension), basename(name));\n\t}\n\tmainNoExtension = mainNoExtension.replace(\n\t\t/(\\.(umd|cjs|es|m))?\\.(mjs|[tj]sx?)$/,\n\t\t'',\n\t);\n\n\tconst mainsByFormat = {};\n\n\tmainsByFormat.es = replaceName(\n\t\tpkg.module && !pkg.module.match(/src\\//)\n\t\t\t? pkg.module\n\t\t\t: pkg['jsnext:main'] || 'x.esm.js',\n\t\tmainNoExtension,\n\t);\n\tmainsByFormat.modern = replaceName(\n\t\t(pkg.syntax && pkg.syntax.esmodules) || pkg.esmodule || 'x.modern.js',\n\t\tmainNoExtension,\n\t);\n\tmainsByFormat.cjs = replaceName(pkg['cjs:main'] || 'x.js', mainNoExtension);\n\tmainsByFormat.umd = replaceName(\n\t\tpkg['umd:main'] || pkg.unpkg || 'x.umd.js',\n\t\tmainNoExtension,\n\t);\n\n\treturn mainsByFormat[format] || mainsByFormat.cjs;\n}\n\n// shebang cache map because the transform only gets run once\nconst shebang = {};\n\nfunction createConfig(options, entry, format, writeMeta) {\n\tlet { pkg } = options;\n\n\t/** @type {(string|RegExp)[]} */\n\tlet external = ['dns', 'fs', 'path', 'url'].concat(\n\t\toptions.entries.filter(e => e !== entry),\n\t);\n\n\t/** @type {Record<string, string>} */\n\tlet outputAliases = {};\n\t// since we transform src/index.js, we need to rename imports for it:\n\tif (options.multipleEntries) {\n\t\toutputAliases['.'] = './' + basename(options.output);\n\t}\n\n\tconst moduleAliases = options.alias ? parseAliasArgument(options.alias) : [];\n\tconst aliasIds = moduleAliases.map(alias => alias.find);\n\n\t// We want to silence rollup warnings for node builtins as we rollup-node-resolve threats them as externals anyway\n\t// @see https://github.com/rollup/plugins/tree/master/packages/node-resolve/#resolving-built-ins-like-fs\n\tif (options.target === 'node') {\n\t\texternal = external.concat(builtinModules);\n\t}\n\n\tconst peerDeps = Object.keys(pkg.peerDependencies || {});\n\tif (options.external === 'none') {\n\t\t// bundle everything (external=[])\n\t} else if (options.external) {\n\t\texternal = external.concat(peerDeps).concat(\n\t\t\t// CLI --external supports regular expressions:\n\t\t\toptions.external.split(',').map(str => new RegExp(str)),\n\t\t);\n\t} else {\n\t\texternal = external\n\t\t\t.concat(peerDeps)\n\t\t\t.concat(Object.keys(pkg.dependencies || {}));\n\t}\n\n\tlet globals = external.reduce((globals, name) => {\n\t\t// Use raw value for CLI-provided RegExp externals:\n\t\tif (name instanceof RegExp) name = name.source;\n\n\t\t// valid JS identifiers are usually library globals:\n\t\tif (name.match(/^[a-z_$][a-z0-9_\\-$]*$/)) {\n\t\t\tglobals[name] = camelCase(name);\n\t\t}\n\t\treturn globals;\n\t}, {});\n\tif (options.globals && options.globals !== 'none') {\n\t\tglobals = Object.assign(globals, parseMappingArgument(options.globals));\n\t}\n\n\tlet defines = {};\n\tif (options.define) {\n\t\tdefines = Object.assign(\n\t\t\tdefines,\n\t\t\tparseMappingArgument(options.define, toReplacementExpression),\n\t\t);\n\t}\n\n\tconst modern = format === 'modern';\n\n\t// let rollupName = safeVariableName(basename(entry).replace(/\\.js$/, ''));\n\n\tlet nameCache = {};\n\tconst bareNameCache = nameCache;\n\t// Support \"minify\" field and legacy \"mangle\" field via package.json:\n\tconst rawMinifyValue = options.pkg.minify || options.pkg.mangle || {};\n\tlet minifyOptions = typeof rawMinifyValue === 'string' ? {} : rawMinifyValue;\n\tconst getNameCachePath =\n\t\ttypeof rawMinifyValue === 'string'\n\t\t\t? () => resolve(options.cwd, rawMinifyValue)\n\t\t\t: () => resolve(options.cwd, 'mangle.json');\n\n\tconst useTypescript = extname(entry) === '.ts' || extname(entry) === '.tsx';\n\n\tconst escapeStringExternals = ext =>\n\t\text instanceof RegExp ? ext.source : escapeStringRegexp(ext);\n\tconst externalPredicate = new RegExp(\n\t\t`^(${external.map(escapeStringExternals).join('|')})($|/)`,\n\t);\n\tconst externalTest =\n\t\texternal.length === 0 ? id => false : id => externalPredicate.test(id);\n\n\tfunction loadNameCache() {\n\t\ttry {\n\t\t\tnameCache = JSON.parse(fs.readFileSync(getNameCachePath(), 'utf8'));\n\t\t\t// mangle.json can contain a \"minify\" field, same format as the pkg.mangle:\n\t\t\tif (nameCache.minify) {\n\t\t\t\tminifyOptions = Object.assign(\n\t\t\t\t\t{},\n\t\t\t\t\tminifyOptions || {},\n\t\t\t\t\tnameCache.minify,\n\t\t\t\t);\n\t\t\t}\n\t\t} catch (e) {}\n\t}\n\tloadNameCache();\n\n\tnormalizeMinifyOptions(minifyOptions);\n\n\tif (nameCache === bareNameCache) nameCache = null;\n\n\t/** @type {false | import('rollup').RollupCache} */\n\tlet cache;\n\tif (modern) cache = false;\n\n\tconst absMain = resolve(options.cwd, getMain({ options, entry, format }));\n\tconst outputDir = dirname(absMain);\n\tconst outputEntryFileName = basename(absMain);\n\n\tlet config = {\n\t\t/** @type {import('rollup').InputOptions} */\n\t\tinputOptions: {\n\t\t\t// disable Rollup's cache for the modern build to prevent re-use of legacy transpiled modules:\n\t\t\tcache,\n\n\t\t\tinput: entry,\n\t\t\texternal: id => {\n\t\t\t\tif (id === 'babel-plugin-transform-async-to-promises/helpers') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (options.multipleEntries && id === '.') {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tif (aliasIds.indexOf(id) >= 0) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn externalTest(id);\n\t\t\t},\n\n\t\t\tonwarn(warning, warn) {\n\t\t\t\t// https://github.com/rollup/rollup/blob/0fa9758cb7b1976537ae0875d085669e3a21e918/src/utils/error.ts#L324\n\t\t\t\tif (warning.code === 'UNRESOLVED_IMPORT') {\n\t\t\t\t\tstdout(\n\t\t\t\t\t\t`Failed to resolve the module ${warning.source} imported by ${warning.importer}` +\n\t\t\t\t\t\t\t`\\nIs the module installed? Note:` +\n\t\t\t\t\t\t\t`\\n ↳ to inline a module into your bundle, install it to \"devDependencies\".` +\n\t\t\t\t\t\t\t`\\n ↳ to depend on a module via import/require, install it to \"dependencies\".`,\n\t\t\t\t\t);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\twarn(warning);\n\t\t\t},\n\n\t\t\ttreeshake: {\n\t\t\t\tpropertyReadSideEffects: false,\n\t\t\t},\n\n\t\t\tplugins: []\n\t\t\t\t.concat(\n\t\t\t\t\tpostcss({\n\t\t\t\t\t\tplugins: [\n\t\t\t\t\t\t\tautoprefixer(),\n\t\t\t\t\t\t\toptions.compress !== false &&\n\t\t\t\t\t\t\t\tcssnano({\n\t\t\t\t\t\t\t\t\tpreset: 'default',\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t].filter(Boolean),\n\t\t\t\t\t\tautoModules: shouldCssModules(options),\n\t\t\t\t\t\tmodules: cssModulesConfig(options),\n\t\t\t\t\t\t// only write out CSS for the first bundle (avoids pointless extra files):\n\t\t\t\t\t\tinject: false,\n\t\t\t\t\t\textract: !!writeMeta,\n\t\t\t\t\t}),\n\t\t\t\t\tmoduleAliases.length > 0 &&\n\t\t\t\t\t\talias({\n\t\t\t\t\t\t\t// @TODO: this is no longer supported, but didn't appear to be required?\n\t\t\t\t\t\t\t// resolve: EXTENSIONS,\n\t\t\t\t\t\t\tentries: moduleAliases,\n\t\t\t\t\t\t}),\n\t\t\t\t\tnodeResolve({\n\t\t\t\t\t\tmainFields: ['module', 'jsnext', 'main'],\n\t\t\t\t\t\tbrowser: options.target !== 'node',\n\t\t\t\t\t\t// defaults + .jsx\n\t\t\t\t\t\textensions: ['.mjs', '.js', '.jsx', '.json', '.node'],\n\t\t\t\t\t\tpreferBuiltins: options.target === 'node',\n\t\t\t\t\t}),\n\t\t\t\t\tcommonjs({\n\t\t\t\t\t\t// use a regex to make sure to include eventual hoisted packages\n\t\t\t\t\t\tinclude: /\\/node_modules\\//,\n\t\t\t\t\t}),\n\t\t\t\t\tcss(),\n\t\t\t\t\t// @ttungbmt\n\t\t\t\t\tvue({\n\t\t\t\t\t\tneedMap: false, // fix: Error: Multiple conflicting contents for sourcemap source\n\t\t\t\t\t\tcss: true\n\t\t\t\t\t}),\n\t\t\t\t\tjson(),\n\t\t\t\t\t{\n\t\t\t\t\t\t// We have to remove shebang so it doesn't end up in the middle of the code somewhere\n\t\t\t\t\t\ttransform: code => ({\n\t\t\t\t\t\t\tcode: code.replace(/^#![^\\n]*/, bang => {\n\t\t\t\t\t\t\t\tshebang[options.name] = bang;\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tmap: null,\n\t\t\t\t\t\t}),\n\t\t\t\t\t},\n\t\t\t\t\tuseTypescript &&\n\t\t\t\t\t\ttypescript({\n\t\t\t\t\t\t\ttypescript: require('typescript'),\n\t\t\t\t\t\t\tcacheRoot: `./node_modules/.cache/.rts2_cache_${format}`,\n\t\t\t\t\t\t\tuseTsconfigDeclarationDir: true,\n\t\t\t\t\t\t\ttsconfigDefaults: {\n\t\t\t\t\t\t\t\tcompilerOptions: {\n\t\t\t\t\t\t\t\t\tsourceMap: options.sourcemap,\n\t\t\t\t\t\t\t\t\tdeclaration: true,\n\t\t\t\t\t\t\t\t\tdeclarationDir: getDeclarationDir({ options, pkg }),\n\t\t\t\t\t\t\t\t\tjsx: 'preserve',\n\t\t\t\t\t\t\t\t\tjsxFactory:\n\t\t\t\t\t\t\t\t\t\t// TypeScript fails to resolve Fragments when jsxFactory\n\t\t\t\t\t\t\t\t\t\t// is set, even when it's the same as the default value.\n\t\t\t\t\t\t\t\t\t\toptions.jsx === 'React.createElement'\n\t\t\t\t\t\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t\t\t\t\t\t: options.jsx || 'h',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tfiles: options.entries,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttsconfig: options.tsconfig,\n\t\t\t\t\t\t\ttsconfigOverride: {\n\t\t\t\t\t\t\t\tcompilerOptions: {\n\t\t\t\t\t\t\t\t\tmodule: 'ESNext',\n\t\t\t\t\t\t\t\t\ttarget: 'esnext',\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}),\n\t\t\t\t\t// if defines is not set, we shouldn't run babel through node_modules\n\t\t\t\t\tisTruthy(defines) &&\n\t\t\t\t\t\tbabel({\n\t\t\t\t\t\t\tbabelHelpers: 'bundled',\n\t\t\t\t\t\t\tbabelrc: false,\n\t\t\t\t\t\t\tcompact: false,\n\t\t\t\t\t\t\tconfigFile: false,\n\t\t\t\t\t\t\tinclude: 'node_modules/**',\n\t\t\t\t\t\t\tplugins: [\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\trequire.resolve('babel-plugin-transform-replace-expressions'),\n\t\t\t\t\t\t\t\t\t{ replace: defines },\n\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t}),\n\t\t\t\t\tcustomBabel()({\n\t\t\t\t\t\tbabelHelpers: 'bundled',\n\t\t\t\t\t\textensions: EXTENSIONS,\n\t\t\t\t\t\texclude: 'node_modules/**',\n\t\t\t\t\t\tpassPerPreset: true, // @see https://babeljs.io/docs/en/options#passperpreset\n\t\t\t\t\t\tcustom: {\n\t\t\t\t\t\t\tdefines,\n\t\t\t\t\t\t\tmodern,\n\t\t\t\t\t\t\tcompress: options.compress !== false,\n\t\t\t\t\t\t\ttargets: options.target === 'node' ? { node: '8' } : undefined,\n\t\t\t\t\t\t\tpragma: options.jsx || 'React.createElement', // @ttungbmt\n\t\t\t\t\t\t\tpragmaFrag: options.jsxFragment || 'Fragment',\n\t\t\t\t\t\t\ttypescript: !!useTypescript,\n\t\t\t\t\t\t\tjsxImportSource: options.jsxImportSource || false,\n\t\t\t\t\t\t},\n\t\t\t\t\t}),\n\t\t\t\t\toptions.compress !== false && [\n\t\t\t\t\t\tterser({\n\t\t\t\t\t\t\tsourcemap: true,\n\t\t\t\t\t\t\tcompress: Object.assign(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tkeep_infinity: true,\n\t\t\t\t\t\t\t\t\tpure_getters: true,\n\t\t\t\t\t\t\t\t\t// Ideally we'd just get Terser to respect existing Arrow functions...\n\t\t\t\t\t\t\t\t\t// unsafe_arrows: true,\n\t\t\t\t\t\t\t\t\tpasses: 10,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tminifyOptions.compress || {},\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\toutput: {\n\t\t\t\t\t\t\t\t// By default, Terser wraps function arguments in extra parens to trigger eager parsing.\n\t\t\t\t\t\t\t\t// Whether this is a good idea is way too specific to guess, so we optimize for size by default:\n\t\t\t\t\t\t\t\twrap_func_args: false,\n\t\t\t\t\t\t\t\tcomments: false,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\twarnings: true,\n\t\t\t\t\t\t\tecma: modern ? 9 : 5,\n\t\t\t\t\t\t\ttoplevel: modern || format === 'cjs' || format === 'es',\n\t\t\t\t\t\t\tmangle: Object.assign({}, minifyOptions.mangle || {}),\n\t\t\t\t\t\t\tnameCache,\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tnameCache && {\n\t\t\t\t\t\t\t// before hook\n\t\t\t\t\t\t\toptions: loadNameCache,\n\t\t\t\t\t\t\t// after hook\n\t\t\t\t\t\t\twriteBundle() {\n\t\t\t\t\t\t\t\tif (writeMeta && nameCache) {\n\t\t\t\t\t\t\t\t\tfs.writeFile(\n\t\t\t\t\t\t\t\t\t\tgetNameCachePath(),\n\t\t\t\t\t\t\t\t\t\tJSON.stringify(nameCache, null, 2),\n\t\t\t\t\t\t\t\t\t\t() => {},\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\t{\n\t\t\t\t\t\twriteBundle(bundle) {\n\t\t\t\t\t\t\tconfig._sizeInfo = Promise.all(\n\t\t\t\t\t\t\t\tObject.values(bundle).map(({ code, fileName }) => {\n\t\t\t\t\t\t\t\t\tif (code) {\n\t\t\t\t\t\t\t\t\t\treturn getSizeInfo(code, fileName, options.raw);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t).then(results => results.filter(Boolean).join('\\n'));\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t)\n\t\t\t\t.filter(Boolean),\n\t\t},\n\n\t\t/** @type {import('rollup').OutputOptions} */\n\t\toutputOptions: {\n\t\t\tpaths: outputAliases,\n\t\t\tglobals,\n\t\t\tstrict: options.strict === true,\n\t\t\tfreeze: false,\n\t\t\tesModule: false,\n\t\t\tsourcemap: options.sourcemap,\n\t\t\tget banner() {\n\t\t\t\treturn shebang[options.name];\n\t\t\t},\n\t\t\tformat: modern ? 'es' : format,\n\t\t\tname: options.name && options.name.replace(/^global\\./, ''),\n\t\t\textend: /^global\\./.test(options.name),\n\t\t\tdir: outputDir,\n\t\t\tentryFileNames: outputEntryFileName,\n\t\t},\n\t};\n\n\treturn config;\n}\n","import sade from 'sade';\r\nlet { version } = require('../package.json');\r\n\r\nconst toArray = val => (Array.isArray(val) ? val : val == null ? [] : [val]);\r\n\r\nexport default handler => {\r\n\tconst ENABLE_MODERN = process.env.MICROBUNDLE_MODERN !== 'false';\r\n\r\n\tconst DEFAULT_FORMATS = ENABLE_MODERN ? 'modern,es,cjs,umd' : 'es,cjs,umd';\r\n\r\n\tconst cmd = type => (str, opts) => {\r\n\t\topts.watch = opts.watch || type === 'watch';\r\n\r\n\t\topts.entries = toArray(str || opts.entry).concat(opts._);\r\n\r\n\t\tif (opts.compress != null) {\r\n\t\t\t// Convert `--compress true/false/1/0` to booleans:\r\n\t\t\tif (typeof opts.compress !== 'boolean') {\r\n\t\t\t\topts.compress = opts.compress !== 'false' && opts.compress !== '0';\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// the default compress value is `true` for web, `false` for Node:\r\n\t\t\topts.compress = opts.target !== 'node';\r\n\t\t}\r\n\r\n\t\thandler(opts);\r\n\t};\r\n\r\n\tlet prog = sade('microbundle');\r\n\r\n\tprog\r\n\t\t.version(version)\r\n\t\t.option('--entry, -i', 'Entry module(s)')\r\n\t\t.option('--output, -o', 'Directory to place build files into')\r\n\t\t.option(\r\n\t\t\t'--format, -f',\r\n\t\t\t`Only build specified formats (any of ${DEFAULT_FORMATS} or iife)`,\r\n\t\t\tDEFAULT_FORMATS,\r\n\t\t)\r\n\t\t.option('--watch, -w', 'Rebuilds on any change', false)\r\n\t\t.option(\r\n\t\t\t'--pkg-main',\r\n\t\t\t'Outputs files analog to package.json main entries',\r\n\t\t\ttrue,\r\n\t\t)\r\n\t\t.option('--target', 'Specify your target environment (node or web)', 'web')\r\n\t\t.option('--external', `Specify external dependencies, or 'none'`)\r\n\t\t.option('--globals', `Specify globals dependencies, or 'none'`)\r\n\t\t.example('microbundle --globals react=React,jquery=$')\r\n\t\t.option('--define', 'Replace constants with hard-coded values')\r\n\t\t.example('microbundle --define API_KEY=1234')\r\n\t\t.option('--alias', `Map imports to different modules`)\r\n\t\t.example('microbundle --alias react=preact')\r\n\t\t.option('--compress', 'Compress output using Terser', null)\r\n\t\t.option('--strict', 'Enforce undefined global context and add \"use strict\"')\r\n\t\t.option('--name', 'Specify name exposed in UMD builds')\r\n\t\t.option('--cwd', 'Use an alternative working directory', '.')\r\n\t\t.option('--sourcemap', 'Generate source map', true)\r\n\t\t.option(\r\n\t\t\t'--css-modules',\r\n\t\t\t'Turns on css-modules for all .css imports. Passing a string will override the scopeName. eg --css-modules=\"_[hash]\"',\r\n\t\t\tnull,\r\n\t\t)\r\n\t\t.example(\"microbundle --no-sourcemap # don't generate sourcemaps\")\r\n\t\t.option('--raw', 'Show raw byte size', false)\r\n\t\t.option(\r\n\t\t\t'--jsx',\r\n\t\t\t'A custom JSX pragma like React.createElement (default: h)',\r\n\t\t)\r\n\t\t.option('--tsconfig', 'Specify the path to a custom tsconfig.json')\r\n\t\t.example('microbundle build --tsconfig tsconfig.build.json');\r\n\r\n\tprog\r\n\t\t.command('build [...entries]', '', { default: true })\r\n\t\t.describe('Build once and exit')\r\n\t\t.action(cmd('build'));\r\n\r\n\tprog\r\n\t\t.command('watch [...entries]')\r\n\t\t.describe('Rebuilds on any change')\r\n\t\t.action(cmd('watch'));\r\n\r\n\t// Parse argv; add extra aliases\r\n\treturn argv =>\r\n\t\tprog.parse(argv, {\r\n\t\t\talias: {\r\n\t\t\t\to: ['output', 'd'],\r\n\t\t\t\ti: ['entry', 'entries', 'e'],\r\n\t\t\t\tw: ['watch'],\r\n\t\t\t},\r\n\t\t});\r\n};\r\n","#!/usr/bin/env node\r\n\r\nimport microbundle from './index';\r\nimport prog from './prog';\r\nimport { stdout } from './utils';\r\nimport logError from './log-error';\r\n\r\nconst run = opts => {\r\n\tmicrobundle(opts)\r\n\t\t.then(({ output }) => {\r\n\t\t\tif (output != null) stdout(output);\r\n\t\t\tif (!opts.watch) process.exit(0);\r\n\t\t})\r\n\t\t.catch(err => {\r\n\t\t\tprocess.exitCode = (typeof err.code === 'number' && err.code) || 1;\r\n\t\t\tlogError(err);\r\n\t\t\tprocess.exit();\r\n\t\t});\r\n};\r\n\r\nprog(run)(process.argv);\r\n"],"names":["fastRestTransform","template","types","t","slice","VISITOR","RestElement","path","state","parentKey","get","scope","generateUidIdentifier","set","args","identifier","key","push","numericLiteral","sliced","callExpression","memberExpression","clone","ident","node","argument","binding","getBinding","name","referencePaths","length","func","parentPath","isArrowFunctionExpression","arrowFunctionToExpression","constant","replaceWith","decl","variableDeclaration","variableDeclarator","unshiftContainer","remove","visitor","Program","childState","Map","useHelper","opts","helper","inlineHelper","literal","expression","ast","traverse","IDENT","addComment","declarations","init","readFile","fs","stat","isDir","then","stats","isDirectory","catch","isFile","stdout","console","log","bind","stderr","error","isTruthy","obj","constructor","Object","keys","removeScope","replace","INVALID_ES3_IDENT","safeVariableName","normalized","toLowerCase","camelCase","ESMODULES_TARGET","esmodules","mergeConfigItems","babel","type","configItemsToMerge","mergedItems","forEach","configItemToMerge","item","itemToMergeWithIndex","findIndex","mergedItem","file","resolved","createConfigItem","merge","options","createConfigItems","items","map","value","require","resolve","environmentPreset","presetEnvRegex","RegExp","createBabelInputPluginFactory","babelCore","custom","customOptions","pluginOptions","config","targets","isNodeTarget","defaultPlugins","jsxImportSource","pragma","pragmaFrag","typescript","defines","modern","inlineHelpers","externalHelpers","minify","transformFastRest","loose","async","legacy","filter","Boolean","babelOptions","envIdx","presets","preset","test","request","assign","useBuiltIns","bugfixes","modules","exclude","runtime","importSource","plugins","compress","generatorOpts","minified","compact","shouldPrintComment","comment","logError","err","description","message","plugin","red","bold","loc","line","column","frame","dim","stack","headlessStack","getPadLeft","str","width","char","repeat","formatSize","size","filename","raw","pretty","prettyBytes","color","green","yellow","indent","white","basename","getSizeInfo","code","gzip","brotli","Promise","all","gzipSize","brotliSize","out","normalizeMinifyOptions","minifyOptions","mangle","properties","regex","reserved","concat","toReplacementExpression","matches","match","JSON","stringify","substring","parseMappingArgument","globalStrings","processValue","globals","split","globalString","r","undefined","Array","isArray","parseAliasArgument","aliasStrings","find","replacement","getConfigFromPkgJson","cwd","hasPackageJson","pkg","packageJson","parse","pkgName","inverse","msg","String","getName","amdName","finalName","shouldCssModules","passedInOption","processCssmodulesArgument","moduleAllCss","allowOnlySuffixModule","cssModulesConfig","isWatchMode","watch","hasPassedInScopeName","generateScopedName","EXTENSIONS","WATCH_OPTS","microbundle","inputOptions","process","sourcemap","input","getInput","entries","source","module","output","getOutput","pkgMain","main","getEntries","multipleEntries","formats","format","from","Set","f","sort","a","b","steps","i","j","createConfig","doWatch","cache","series","outputOptions","bundle","rollup","write","_sizeInfo","targetDir","relative","dirname","banner","blue","join","onStart","onBuild","onError","reject","watchers","reduce","acc","on","e","text","trim","jsOrTs","extension","glob","getDeclarationDir","result","typings","arr","indexOf","replaceName","getMain","entry","mainNoExtension","mainsByFormat","es","syntax","esmodule","cjs","umd","unpkg","shebang","writeMeta","external","outputAliases","moduleAliases","alias","aliasIds","target","builtinModules","peerDeps","peerDependencies","dependencies","define","nameCache","bareNameCache","rawMinifyValue","getNameCachePath","useTypescript","extname","escapeStringExternals","ext","escapeStringRegexp","externalPredicate","externalTest","id","loadNameCache","readFileSync","absMain","outputDir","outputEntryFileName","onwarn","warning","warn","importer","treeshake","propertyReadSideEffects","postcss","autoprefixer","cssnano","autoModules","inject","extract","nodeResolve","mainFields","browser","extensions","preferBuiltins","commonjs","include","css","vue","needMap","json","transform","bang","cacheRoot","useTsconfigDeclarationDir","tsconfigDefaults","compilerOptions","sourceMap","declaration","declarationDir","jsx","jsxFactory","files","tsconfig","tsconfigOverride","babelHelpers","babelrc","configFile","customBabel","passPerPreset","jsxFragment","terser","keep_infinity","pure_getters","passes","wrap_func_args","comments","warnings","ecma","toplevel","writeBundle","writeFile","values","fileName","results","paths","strict","freeze","esModule","extend","dir","entryFileNames","version","toArray","val","handler","ENABLE_MODERN","env","MICROBUNDLE_MODERN","DEFAULT_FORMATS","cmd","_","prog","sade","option","example","command","default","describe","action","argv","o","w","run","exit","exitCode"],"mappings":"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"}